<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Bãnbou</title>
<style>
body{
  margin:0;
  font-family:'Comic Sans MS',sans-serif;
  background:#fffbee;
  overflow:hidden;
  touch-action:pan-y;
}
#app{
  position:relative;
  width:100%;
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card{
  position:absolute;
  width:90%;
  max-width:340px;
  height:70%;
  background:#fff;
  border-radius:20px;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  transition:transform 0.3s ease,opacity 0.3s ease;
}
.card img{
  width:100%;
  height:100%;
  object-fit:cover;
}
.message-bubble{
  position:absolute;
  bottom:10%;
  left:50%;
  transform:translateX(-50%);
  background:#f0f0f0;
  border-radius:18px;
  padding:12px 18px;
  max-width:80%;
  box-shadow:0 3px 6px rgba(0,0,0,0.1);
  display:none;
  font-size:0.95rem;
}
.message-bubble.show{display:block;}
.alerta{
  position:absolute;
  top:8%;
  left:50%;
  transform:translateX(-50%);
  color:#ff2c2c;
  font-weight:bold;
  font-size:1.1rem;
  display:none;
}
.alerta.show{display:block;}
</style>
</head>
<body>
<div id="app">
  <div class="card" id="kogos"><img src="kogos.jpg" alt="Kogos"></div>
  <div class="card" id="serj"><img src="serj.jpg" alt="Serj Tankian"></div>
  <div class="card" id="joe"><img src="joe.jpg" alt="Joe Duplantier"></div>
  <div class="card" id="tomatinho"><img src="tomatinho.jpg" alt="Tomatinho"></div>
  <div class="message-bubble" id="message">
    oi, aqui é o <s>careca</s> cabeludo que gosta de gojira e system of a down, me chama no zap 
    <a href="#" style="color:#007bff;text-decoration:none;">91234-5678</a>
  </div>
  <div class="alerta" id="alerta">⚠️ ALERTA: NÃO É O TUMATI ⚠️</div>
</div>

<script>
const cards = [...document.querySelectorAll('.card')];
const message = document.getElementById('message');
const alerta = document.getElementById('alerta');
let current = 0;

// --- ÁUDIO CONTROLADO (funciona no iOS) ---
let serjCtx, serjGain, serjSource;
async function playSerj() {
  try {
    serjCtx = new (window.AudioContext || window.webkitAudioContext)();
    const response = await fetch('serj.mp3');
    const arrayBuffer = await response.arrayBuffer();
    const audioBuffer = await serjCtx.decodeAudioData(arrayBuffer);

    serjSource = serjCtx.createBufferSource();
    serjSource.buffer = audioBuffer;

    serjGain = serjCtx.createGain();
    serjGain.gain.value = 0; // começa silencioso

    serjSource.connect(serjGain);
    serjGain.connect(serjCtx.destination);

    serjSource.start(0);

    // fade-in suave até 0.6
    let current = 0;
    const fade = setInterval(()=>{
      current += 0.05;
      if(current >= 0.6){ current = 0.6; clearInterval(fade); }
      serjGain.gain.value = current;
    },100);
  } catch(e) {
    console.error("Erro ao tocar áudio:", e);
  }
}

// --- GESTO DE SWIPE ---
let startX = 0;
let isSwiping = false;

function onStart(e){
  startX = e.touches ? e.touches[0].clientX : e.clientX;
  isSwiping = true;
}

function onMove(e){
  if(!isSwiping) return;
  const x = e.touches ? e.touches[0].clientX : e.clientX;
  const dx = x - startX;
  const card = cards[current];
  if(card) card.style.transform = `translateX(${dx}px) rotate(${dx/20}deg)`;
}

function onEnd(e){
  if(!isSwiping) return;
  isSwiping = false;
  const x = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
  const dx = x - startX;
  const card = cards[current];
  if(!card) return;

  if(Math.abs(dx) > 80){
    // swipe pra fora
    const dir = dx > 0 ? 120 : -120;
    card.style.transform = `translateX(${dir}%) rotate(${dir/10}deg)`;
    card.style.opacity = '0';
    setTimeout(()=>card.style.display='none',300);
    
    if(current === 0){ // Kogos -> Serj
      alerta.classList.add('show');
      playSerj();
      setTimeout(()=>alerta.classList.remove('show'), 2000);
    }

    if(current === 2){ // depois do Joe -> Tomatinho
      setTimeout(()=>message.classList.add('show'), 800);
    }

    current++;
  } else {
    // volta ao centro
    card.style.transform = '';
  }
}

document.body.addEventListener('mousedown', onStart);
document.body.addEventListener('touchstart', onStart);
document.body.addEventListener('mousemove', onMove);
document.body.addEventListener('touchmove', onMove);
document.body.addEventListener('mouseup', onEnd);
document.body.addEventListener('touchend', onEnd);
</script>
</body>
</html>
